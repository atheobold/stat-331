---
title: "Factors, Strings, & Dates"
format: 
  html: 
    theme: minty
    fontsize: 1em
    mainfont: sans-serif
    number-sections: true
    number-depth: 2
    code-block-bg: "#76b5c5"
    highlight-style: monochrome
editor: visual
execute: 
  echo: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
### change this if icons local
```

```{r, include = FALSE}
library(tidyverse)
library(flair)
library(lubridate)
```

------------------------------------------------------------------------

`r emo::ji("play button")` Watch Videos: 25 minutes

`r emo::ji("book")` Readings: 30-60 minutes

`r emo::ji("computer")` Activities: 45-60 minutes

`r emo::ji("check")` Check-ins: 2

---

# Factors

`r emo::ji("book")` [Required Reading: *R4DS* -- Factors with forcats](https://r4ds.had.co.nz/factors.html)

`r emo::ji("play button")` [Required Video: Factors with forcats](http://somup.com/crfTrOF3tN)

---

`r emo::ji("check")` **Check-in: Functions from forcats** 

Answer the questions based on the reading, video, **forcats**
[website](https://forcats.tidyverse.org/reference/index.html), or 
**forcats** [cheat sheet](https://www.rstudio.com/resources/cheatsheets/). 

**Q1** Which of the following tasks can `fct_recode()` accomplish?

- changes the values of the factor levels
- reorders the levels of a factor
- remove levels of a factor you don't want
- collapse levels of a factor into a new level

**Q2** Which of the following tasks can `fct_relevel()` accomplish? 

- reorders the levels of a factor
- changes the values of the factor levels
- remove levels of a factor you don't want
- collapse levels of a factor into a new level

**Q3** What is the main difference between `fct_collapse()` and `fct_recode()`?

- `fct_recode()` uses strings to create factor levels
- `fct_recode()` uses groups to create factor levels
- `fct_recode()` cannot create an "Other" group


**Q4** What ordering do you get with `fct_reorder()`?

- largest to smallest based on another variable
- order of appearance
- largest to smallest based on counts
- alphabetical order

**Q5** What ordering do you get with `fct_inorder()`?

- order of appearance
- alphabetical order
- largest to smallest based on counts
- largest to smallest based on another variable

*Feel free to share answers with your classmates in the Discord server, to make
sure you understand.*

`r emo::ji("check")` **Check-in: Apply your skills**

In your *colleges_clean* dataset, adjust the `REGION` variable to have nicer or
clearer labels and/or better categories.

---

# Strings

`r emo::ji("book")` [Required Reading: *R4DS* -- Strings](https://r4ds.had.co.nz/strings.html)

`r emo::ji("play button")` [Required Video -- Strings with stringr](https://www.youtube.com/watch?v=Oo_MtXwpi2Q)  

---

`r emo::ji("check")` **Check-in: Functions from stringr**

Answer the questions based on the reading, video, **stringr**
[website](https://stringr.tidyverse.org/reference/index.html), or 
**stringr** [cheat sheet](https://www.rstudio.com/resources/cheatsheets/). 

**Q1** Which of the follow are differences between `length()` and `str_length()`?

- `length()` gives the number of elements in a vector
- `str_length()` gives the number of characters in a string
- `str_length()` gives the number of strings in a vector
- `length()` gives the dimensions of a dataframe

**Q2** What of the following is true about `str_replace()`? 

- `str_replace()` replaces the first instance of the pattern
- `str_replace()` replaces the last instance of the pattern
- `str_replace()` replaces every instance of the pattern

**Q3** `str_trim()` allows you to remove whitespace on what sides 

- both
- left
- right

**Q4** Which of the following does `str_sub()` use to create a substring? 

- starting position
- ending position
- pattern to search for

**Q5** Which of the following does `str_subset()` use to create a substring? 

- starting position
- ending position
- pattern to search for

**Q6** What does the collapse argument do in str_c()?

- specifies a string to be used when combining inputs into a single string
- specifies whether the string should be collapsed

*Feel free to share answers with your classmates in the Discord server, to make
sure you understand.*

`r emo::ji("check")` **Check-in: Apply your skills**

Using your *colleges_clean* dataset, answer these questions:

**Question 1:** How *exactly* does Cal Poly's name appear in this dataset?

```{r, include = FALSE, eval = FALSE}
colleges_clean$INSTNM %>%
  str_subset("Polytechnic")
```

**Question 2:** How many colleges have the word "University" in their name?

```{r, include = FALSE, eval = FALSE}
colleges_clean %>%
  mutate(
    is_univ = str_detect(INSTNM, "University")
  ) %>%
  count(is_univ)

```

**Question 3:** Which college has the *longest* name?  The *shortest* name?

```{r, include = FALSE, eval = FALSE}
colleges_clean %>%
  mutate(
    name_len = str_length(INSTNM)
  ) %>% 
  slice_min(name_len) 

colleges_clean %>%
  mutate(
    name_len = str_length(INSTNM)
  ) %>% 
  slice_max(name_len) 

```

---

# Dates

`r emo::ji("play button")` [Required Video: DateTime Objects with lubridate](http://somup.com/crfTrLF3U3)

`r emo::ji("book")` [Required Reading: *R4DS* -- Dates and Times](https://r4ds.had.co.nz/dates-and-times.html)

**Extra Resources**

* [A more in-depth discussion of the POSIXlt and POSIXct data classes.](https://www.cyclismo.org/tutorial/R/time.html)

* [A tutorial on lubridate](https://data.library.virginia.edu/working-with-dates-and-time-in-r-using-the-lubridate-package/) - scroll down for details on intervals if 
you have trouble with `%within%` and `%--%`

---

`r emo::ji("check")` **Check-in: Functions from lubridate**

Answer the questions based on the reading, video, **lubridate**
[website](https://lubridate.tidyverse.org/reference/index.html), or 
**lubridate** [cheat sheet](https://www.rstudio.com/resources/cheatsheets/). 

**Q1** Which of the following is true about the year() function?

- `year()` extracts the year of a datetime object
- `year()` creates a duration object to be added to a datetime

**Q3** What `tz` would you use for San Luis Obispo? 

<!-- tz = "America/Los_Angeles" -->

**Q3** Which of the following is true about the `%within%` operator?

- it checks if a date is included in an interval
- it returns a logical value
- it creates an interval with a start and end time
 
**Q4** Which of the following is true about the `%--%` operator?

- it creates an interval with a start and end time
- it returns a logical value
- it checks if a date is included in an interval


**Q5** What day does the `make_date()` function use as default if no `day`
argument is provided?

*Feel free to share answers with your classmates in the Discord server, to make
sure you understand.*

`r emo::ji("check")` **Check-in: Apply your skills**

(Answer the following using code (even if you know the answer already).

First, use the `make_date()` function to save your birthday as a
Datetime object in R.  

```{r, include = FALSE}
bday <- make_date(day = 14, month = 1, year = 1989)
```

- What day of the week does/did your birthday fall on in 2023?

```{r, include = FALSE}
(bday  + years(34)) %>% 
  wday(label = TRUE)
```

- On what day of the week should you plan your 50th birthday party?

```{r, include = FALSE}
(bday  + years(50)) %>% 
  wday(label = TRUE)
```

- Find the date that is exactly 9 months before the day you were born.  If it
falls on a holiday, think about the implications.

```{r, include = FALSE}
bday - months(9)
```
