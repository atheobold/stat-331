---
title: "Lab 3: HipHop Lyrics"
author: "Solutions by Dr. Theobold"
output:
  prettydoc::html_pretty:
    theme: tactile
    highlight: github
    css: styles.css
---

```{r global_options, include = FALSE}
knitr::opts_chunk$set(fig.width = 12, 
                      fig.height = 8,
                      fig.path = 'Figs/',
                      echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      eval = TRUE)

```

## The dataset

The data set "hiphop" contains results from a study conducted by a linguist at the University of Minnesota.  The researcher was interested in predicting musical taste based on familiarity with African American English (AAE).  168 subjects participated in the study, and each was asked to define 64 different AAE terms.  The definitions given were used to create a "familiarity" score for each subject for each term.  This score quantifies how well the subject knew the term on a scale of 1-5 (1 = not at all, 5 = very well).  Before tackling the problems, **study the information on the following website**, which includes a description of each variable:

[http://conservancy.umn.edu/bitstream/handle/11299/116327/5/explanationAAEHiphopChesley.txt](http://conservancy.umn.edu/bitstream/handle/11299/116327/5/explanationAAEHiphopChesley.txt)

```{r, message = FALSE}
library(tidyverse)
library(forcats) ## Dr. Theobold's preferred way to work with factors!

hiphop <- read_csv(here::here("3_dplyr", "Lab-hiphop-dplyr", "hiphop.csv"))
```


---

## Assignment

### Summary

#### 1. 

Provide a brief overview (2-4 sentences) of the dataset. (It is always good
practice to start an analysis by getting a feel for the data and providing a
quick summary for readers.) You do **not** need to show any source code for this
question, although you probably want to use code to get information.

**Possible response:**  

_This dataset has 10,752 rows and 38 columns, representing responses for each 
participant to their familiarity with African-American English. These data are 
the result of a study with 168 participants who were asked to define AAE terms, 
as well as some accompanying demographic information. The free response 
definitions participants gave were turned into five-point Likert scale items 
reflecting their familiarity with the term (1 = not at all, 5 = well)._ 


#### 2. 

What are the rows of this dataset?  It is __not__ one person per row! 

**Possible response:** 

_Every row in the dataset is a word for each participant. When we look at the 
dataset, we see that the first 168 rows are for the **same** word, but different
participants. Thus, we will have 168 rows for each word!_


#### 3. 

Missing values for some of the variables were replaced with other values. How 
were missing values replaced? What do you believe are some benefits and
drawbacks of doing this? 

**Possible response:** 

_Missing values were replaced with mean values for some of the variables in the 
dataset. This is beneficial, since there are fewer instances of missing data. 
This is possibly a bad choice if the mean is not representative of what that 
individual would have responded. For example, if an individual didn't respond 
to the question "How many African-Americans do you have contact with on a weekly
basis?", I would be inclined to think their answer might be closer to 0 than to 
the mean!_ 


#### 4. 

Clean the dataset in whichever ways you see fit.  This might mean adjusting
*variable type*, for example from "character" to "factor", or dealing with
missing data.

**Possible response:** 

```{r}
hiphop <- hiphop %>% 
  mutate(sex = as_factor(sex), 
         ethnic = as_factor(ethnic)) %>% 
  filter(city > 0)
```

_I chose not to omit any missing values, since there were no missing values for 
`familiarity`, `sex`, `age`, and `ethnic`. I did, however, choose to remove 
observations with a city population of 0, since that seemed a bit unreasonable 
and likely should have been an `NA`._  

```{r, include = FALSE}

hiphop %>% filter(!is.na(familiarity)) %>% dim()
hiphop %>% filter(!is.na(sex), 
                  !is.na(age), 
                  !is.na(ethnic)) %>% dim()

hiphop %>% filter(city == 0) %>% dim()

```



#### 5. 

How many unique AAVE words were studied in this dataset?

```{r}
hiphop %>%
  distinct(word) %>%
  count()
```

_There were 64 unique AAVE words included in the study._

#### 6. 

Make a new variable that re-categorizes `ethnic` into only two groups, "white" and "non-white", to simplify your data.

```{r}
hiphop <- hiphop %>%
  mutate(
    ethnic_group = if_else(ethnic == "white", "white", "non-white"),
    ethnic_group = as_factor(ethnic_group)
  )
```

**Note:** Personally, I like the `as_factor()` function from the **forcats** 
package more than the `as.factor()` function. We will learn more about this 
package and its functions in week 5. 


#### 7. 

What are the demographics of the people in this study?  Investigate the
variables `sex`, `age`, and `ethnic` and summarize your findings in 1-3 complete sentences.  


```{r}
subjects <- hiphop %>% 
  distinct(subj, .keep_all = TRUE)
      

subjects %>% 
  select(age, sex, ethnic, ethnic_group) %>% 
  summary()
```

**Possible response:**

_Of the 168 participants in the study, 117 identified as female and 51 identified
as male (given binary options). Additionally, 135 subjects identified as White,
while 33 identified as non-white (Asian, Indian, Native, Black, African,
Hispanic, Biracial, Unknown). The ages of the participants ranged from 16 to 48,
with a median of 19 (mean of 20)._


#### 8. 

Make at least two plots to display the demographic information of the subjects
in this study.  You **do not** need to discuss these plots, but make sure they
are appropriate to the data types and have informative titles and axis labels.


```{r}
## Many options exist, but I like these: 

subjects %>% 
  ggplot(aes(x = age)) + 
  geom_histogram(binwidth = 2) +
  facet_wrap(~ sex) + 
  labs(x = "Age", 
       title = "Participant Ages by Identified Sex")

subjects %>% 
  ggplot(aes(x = age)) + 
  geom_histogram(binwidth = 2) +
  facet_wrap(~ ethnic_group) + 
  labs(x = "Age", 
       title = "Participant Ages by Identified Ethnic Group")

subjects %>% 
  ggplot(aes(x = ethnic_group, fill = sex)) + 
  geom_bar(position = "dodge") +
  labs(fill = "Self-reported \nSex", 
       x = "Self-reported Ethnicity", 
       title = "Participant Identified Sex and Ethnicity")
```


### Familiar words

#### 1.  

For each demographic group listed below, determine which word(s) in this study
was(were) the most **and** least familiar on average.

a. People below the age of 20

```{r}
young <- hiphop %>% 
  filter(age < 20) %>% 
  group_by(word) %>% 
  summarize(mean_fam = mean(familiarity)) 
  ## Although I am generally opposed to taking the mean of Likert data, this gives an "easy" answer

## Most familiar
young %>% 
  slice_max(mean_fam) %>% 
  pull(word)

## Least familiar
young %>% 
  slice_min(mean_fam) %>% 
  pull(word)
```

b. Non-white women

```{r}
nonwhite_women <- hiphop %>% 
  filter(sex == "Female", 
         ethnic_group == "non-white") %>% 
  group_by(word) %>% 
  summarize(mean_fam = mean(familiarity)) 

# Most familiar
nonwhite_women %>% 
  slice_max(mean_fam) %>% 
  pull(word)

## Least familiar
nonwhite_women %>% 
  slice_min(mean_fam) %>% 
  pull(word)

```

c. White men above the age of 30

```{r}
old_white_men <- hiphop %>% 
  filter(sex == "Male", 
         ethnic_group == "white", 
         age > 30) %>% 
  group_by(word) %>% 
  summarize(mean_fam = mean(familiarity)) 

## Most familiar
old_white_men %>% 
  slice_max(mean_fam) %>% 
  pull(word)

## Least familiar
old_white_men %>% 
  slice_min(mean_fam) %>% 
  pull(word)

```


#### 2. 

For each demographic comparison below, determine which music genre most
differentiates the groups.  That is, which genre had much higher average (mean
or median) score in one group than the other.

```{r}

genres <- hiphop %>%
  select(sex, ethnic_group, age, intl:hiphop)

```

a. Male versus Female

```{r}
genres %>% 
  group_by(sex) %>%
  ## For all of the music genres, find the mean for each sex
  summarize(across(intl:hiphop, mean)) %>% 
  ## For all of the music genres, find the difference in the sexes
  summarise(across(intl:hiphop, diff)) %>% 
  ## Make the differences all positive to compare magnitudes
  summarise(across(intl:hiphop, abs)) %>% 
  which.max()

```


b. White versus Non-White

```{r}
genres %>% 
  group_by(ethnic_group) %>%
  ## For all of the music genres, find the mean for each sex
  summarize(across(intl:hiphop, mean)) %>% 
  ## For all of the music genres, find the difference in the sexes
  summarise(across(intl:hiphop, diff)) %>% 
  ## Make the differences all positive to compare magnitudes
  summarise(across(intl:hiphop, abs)) %>% 
  which.max()

```


--- 

### Challenge: Use the data

A former Canadian child TV star named Aubrey Graham is interested in switching
careers to become a rapper.  Aubrey hires you to consult the `hiphop` dataset to
help compose his new songs. 

#### Step 2 

Aubrey's true life dream is to collaborate with his fellow Canadian musician
Justin Bieber.  Luckily, he knows that Bieber himself was one of the subjects in
this study!  You know that Bieber is a white male, aged 17-23 at the time of the
study, from a relatively small town (10,000-60,000 people) in Ontario.

Determine which subject is secretly Bieber, and justify your answer.

*Hint: Refer again to the dataset description.  There is another clue about Bieber's identity.*


```{r}
hiphop %>% 
  distinct(subj, .keep_all = TRUE) %>%
  filter(sex == "Male",
         age <= 23, 
         age >= 17,
         city < 60000,
         city > 10000) %>%
  top_n(1, bieber) %>%
  select(subj)

```

_Justin Bieber is subject "p17."_ 

#### Step 1

Aubrey hopes that his songs will be perceived as authentically hiphop. Although
Aubrey wants to be authentic, he also hopes to sell records, of course.
Two titles have been suggested for his first album: "Hotline Boo" or
"Hella Bling".  Based on the dataset, which will appeal more to the higher
population areas?  Make at least one plot to support your answer.

*Hint: Consider first converting the population variable(s) to categories, such
as "large", "medium", and "small".  You may also want to use the `fam1` variable
instead of `familiarity`*

```{r}

titles <- hiphop %>% 
  filter(word %in% c("boo", "hella")) %>%
  mutate(
    city_size = case_when(
      city > 200000 ~ "Large",
      city > 50000 ~ "Medium",
      TRUE ~ "Small"
    )
  )


ggplot(titles, 
       aes(x = city_size, y = fam1, fill = word)) + 
  geom_col(position = "fill")

```

_Based on the plot, it appears that an album titled "Hella Bling" would be more 
popular in almost every city, regardless of size. Across all three city sizes 
(large, medium, small), "Hello" had over a 50% familiarity. For small cities, 
it appears that the familiarity of "boo" and "hella" is nearly identical (50-50), 
and thus for this city size both album titles may be equally popular._ 


#### Step 3

Use the dataset to suggest a track listing (11 song titles) for Aubrey's next
album with the Biebs.  In your Think Out Loud Recording you will be expected to 
explain your thought process and the code you produced. 

