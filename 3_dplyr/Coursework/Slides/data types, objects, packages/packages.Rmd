---
title: "The Nuances of R Packages"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "slide-style.css"]
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r xaringan-themer, include=FALSE}
library(xaringanthemer)
library(xaringan)
library(tidyr)

style_duo_accent(
  primary_color      = "#0F4C81", # pantone classic blue
  secondary_color    = "#B6CADA", # pantone baby blue
  header_font_google = google_font("Raleway"),
  text_font_google   = google_font("Raleway", "300", "300i"),
  code_font_google   = google_font("Source Code Pro"),
  text_font_size     = "30px"
)
```

class: center, middle, inverse

.hand-large[Installing packages]

---

.bitlarger[`install.packages()`]

To use a package, it must first be *installed* to your copy of R.

This only needs to happen **ONCE** per computer or server.

```{r install packages, eval = FALSE}
install.packages("tidyverse")
```

---

.bitlarger[`update.packages()`]

If a computer you are using has the package, but you aren't sure if it's up to date:

```{r update packages, eval = FALSE}
update.packages("tidyverse")
```

to install the most recent version.

---
class: center, middle

.bitlarger[**NEVER EVER EVER EVER PUT `install.packages()` or `update.packages()` INTO YOUR R MARKDOWN FILE!!!!!**]

---

class: center, middle, inverse

.hand-large[Loading Packages]

---

.bitlarger[`library()`]

- A package must only be *installed* once.

- But it must be *loaded* every time, to tell R it is needed for this analysis.

- `library` gives an **error** if the package isn't installed

```{r library, eval = FALSE}
library(tidyverse)

# notice:  no quotes around package name
```

---
class: center, middle, inverse

.hand-medium[Three annoying complications of packages]

---
class: center, middle, inverse

.hand-medium[Versions]

---

.larger[Versions]

- From time to time, packages get updated

- This is good!

- But, it can mess with your code, which depended on the older version.

- Outside the scope of this class; just be aware.


---

class: center, middle, inverse

.hand-large[Dependencies]

---

## Dependencies

- A *dependency* is when one package makes use of another.

- For example, if you create an Rpackage that uses the function `group_by()`,
your package **depends** on `dplyr`

- Typically these get loaded automatically!

- Occasionally, something goes weird and you need to manually install the
dependency.


---
class: center, middle, inverse

.hand-large[Conflicts]

---

class: center 

.larger[Conflicts]

Sometimes, packages choose the same name for their functions.

This is called a *conflict*.

---

.bitlarger[For example...]

```{r, eval = FALSE}
library(tidyverse)
```

```
── Attaching packages ──────────────────────────── tidyverse 1.3.0 ──
✓ ggplot2 3.3.3     ✓ purrr   0.3.4
✓ tibble  3.1.0     ✓ dplyr   1.0.5
✓ tidyr   1.1.3     ✓ stringr 1.4.0
✓ readr   1.4.0     ✓ forcats 0.5.1
── Conflicts ─────────────────────────────── tidyverse_conflicts() ──
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
```
---

## Order Matters - Part 1

```{r conflicts1, message = FALSE}
dat <- data.frame(bob = 1:10, joe = 11:20)

library(MASS)
library(dplyr)
```

```{r, error = TRUE}
dat %>% select(bob)
```

---

## Order Matters - Part 2

```{r, echo = FALSE, message = FALSE, warning = FALSE}
detach("package:dplyr", unload=TRUE)
detach("package:MASS", unload=TRUE)
```

```{r conflicts2, message = FALSE}
dat <- data.frame(bob = 1:10, joe = 11:20)

library(dplyr)
library(MASS)
```

```{r, error = TRUE}
dat %>% select(bob)
```

