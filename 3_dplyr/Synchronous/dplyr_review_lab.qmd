---
title: "A Few More Data Wrangling Tools"
author: "STAT 331"
format: 
  revealjs:
    logo: images/dplyr.png
    theme: night
    self-contained: true
editor: visual
execute: 
  warning: false
  message: false
---

```{r packages}
#| include: false
library(tidyverse)
```

##  {background-color="#D4D4D4"}

::: {style="margin-top: 100px; font-size: 2em; color: #000000;"}
Peer Code Review
:::

. . .

::: {style="font-size: 1.25em;"}
```
ggplot(data = surveys, mapping = aes(x=hindfoot_length,y= weight)) +  
  geom_jitter(alpha=.2,color='tomato')+ facet_wrap(~species)+geom_boxplot(outlier.shape = NA)+labs(
    title ='Weight to hindfoot comparison'
  )+ xlab('length (mm)')+ylab('Weight(g)')
```
:::

. . .

</br>
</br>

::: {style="font-size: 1.5em;color: #dd5227"}

What feedback would you give?

:::



##  {background-color="#D4D4D4"}

::: {style="margin-top: 100px; font-size: 2em; color: #000000;"}
Defining Grades in 331
:::

. . .

</br>

-   A: **Superior** Attainment of Course Objectives

-   B: **Good** Attainment of Course Objectives

-   C: **Acceptable** Attainment of Course Objectives

-   D: **Poor** Attainment of Course Objectives

::: aside
::: {style="color: #dd5227;"}
[STAT 331 / 531 Syllabus](https://docs.google.com/document/d/1-SSRp_mXFNgYiy4uW9tlcpxDpQH4OuMqK-Hh4v5AvZI/edit?usp=sharing)
:::
:::

##  {background-color="#D4D4D4"}

::: {style="margin-top: 100px; font-size: 2em; color: #000000;"}
A few words about `drop_na()`
:::

. . .

::: incremental
-   Easy tool to remove missing values
-   Unilaterally removes **any** row with a missing value for **any** variable
-   **But** you can specify what columns it should look at for missing values!
:::

## 

::: {style="margin-top: 50px; font-size: 2em; color: #dd5227;"}
Summarizing Frequencies
:::

. . .

::: columns
::: {.column width="40%"}
`count()` -- counts the values of one or more **categorical** variables
:::

::: {.column width="5%"}
:::

::: {.column width="55%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: false
starwars |> 
  count(homeworld)
```
:::
:::

. . .

::: columns
::: {.column width="40%"}
The `sort` argument specifies if the resulting tibble should be sorted in descending order
:::

::: {.column width="5%"}
:::

::: {.column width="55%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: false
starwars |> 
  count(homeworld, 
        sort = TRUE)
```
:::
:::

## 

::: {style="margin-top: 50px; font-size: 2em; color: #dd5227;"}
Finding Unique Groups
:::

. . .

`distinct()` -- selects the unique / distinct rows from a dataset

. . .

<center>

::: {style="font-size: 1.5em;"}
**Arguments**
:::

</center>

::: incremental
-   `...` -- variables to use when determining uniqueness
    -   can use multiple!
-   `.keep_all` -- decides if all of the columns should be kept
    -   `FALSE` is default!
:::

## 

::: {style="margin-top: 50px; font-size: 2em; color: #dd5227;"}
Discritizing Variables
:::

::: incremental
-   `if_else()`
    -   Useful when there are two options
-   `case_when()`
    -   Useful when there are three or more options
:::

## 

![](images/case_when_horst.png)

##  {background-color="#D4D4D4"}

::: {style="margin-top: 50px; font-size: 2em; color: #000000;"}
What if I want to perform the same operation across multiple columns?
:::

## 

::: {style="margin-top: 50px; font-size: 2em; color: #dd5227;"}
`across()`
:::

. . .

> makes it easy to apply the same transformation to multiple columns, allowing you to use `select()` semantics inside in "data-masking" functions like `summarise()` and `mutate()`

. . .

</br>

::: {style="font-size: 1.25em;"}
`across(.cols = everything(), .fns = NULL, ...)`
:::

<!-- `.cols` -- columns in data to select -->

<!-- `.fns` -- functions to apply to selected columns -->

<!-- `...` -- additional arguments for the function calls (from `.fns`) -->

## 

::: {style="margin-top: 50px; font-size: 2em; color: #dd5227;"}
Summarizing Multiple Columns
:::

. . .

```{r}
#| output-location: fragment
#| echo: true
starwars |> 
  summarise(
    across(
      height:mass, 
      mean, 
      na.rm = TRUE
      )
    )
```

## 

::: {style="margin-top: 50px; font-size: 2em; color: #dd5227;"}
Conditional Summarizing
:::

```{r}
#| output-location: fragment
#| echo: true
starwars |> 
  summarise(
    across(
      where(is.numeric), 
      mean, 
      na.rm = TRUE
      )
    )

```

## 

![](images/across_horst.png)

## `r emo::ji("heart")` `|>`

```{r}
#| echo: true
#| output-location: slide
#| out-width: 60%
#| fig-align: center

starwars |> 
  drop_na(homeworld) |> 
  filter(gender == "feminine") |>
  ggplot(mapping = aes(y = homeworld, fill = homeworld)) + 
  geom_bar(position = "dodge") + 
  labs(title = "Homeworlds of Feminine Starwars Characters", 
       y = "") + 
  theme(legend.position = "none", 
        plot.title = element_text(size = 28), 
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20), 
        axis.title.x = element_text(size = 24)
        )
  
```

. . .

</br>

If you use a `|>` instead of a `+`:

    Error in `validate_mapping()`:
    Did you use %>% instead of +?

# Implication of Data Ethics

## Data Science Oath

::: {style="font-size: 0.65em;"}
> I will not be ashamed to say, "I know not," nor will I fail to call in my colleagues when the skills of another are needed for solving a problem.

> I will respect the privacy of my data subjects, for their data are not disclosed to me that the world may know, so I will tread with care in matters of privacy and security.

> I will remember that my data are not just numbers without meaning or context, but represent real people and situations, and that my work may lead to unintended societal consequences, such as inequality, poverty, and disparities due to algorithmic bias.
:::

::: aside
-   [National Academy of Sciences](https://en.wikipedia.org/wiki/National_Academy_of_Sciences)
-   [Data Values and Principles](https://datapractices.org/manifesto/)
:::

## ASA Ethical Guidelines

::: {style="font-size: 0.9em;"}
The American Statistical Association's Ethical Guidelines for Statistical Practice are intended to help statistics practitioners make decisions ethically. Additionally, the ethical guidelines aim to promote accountability by informing those who rely on statistical analysis of the standards they should expect.
:::

::: aside
[Ethical Guidelines for Statistical Practice](https://www.amstat.org/your-career/ethical-guidelines-for-statistical-practice)
:::

## Institutional Review Board

::: {style="font-size: 0.9em;"}
IRB reviews help to ensure that research participants are protected from research-related risks and treated ethically, a necessary prerequisite for maintaining the public's trust in the research enterprise and allowing science to advance for the common good.
:::

::: callout-note
[Watch a video about IRB](https://www.youtube.com/watch?v=U8fme1boEbE&ab_channel=U.S.DepartmentofHealthandHumanServices) to learn more.
:::
