---
title: "Distributions and Simulation"
author: ""
output:
  prettydoc::html_pretty:
    theme: tactile
    highlight: github
    css: styles.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

`r emo::ji("play button")` Watch Videos: __ minutes
  
  * `r emo::ji("link")` Link to **all** Slides from Videos: [here](https://app.box.com/s/ae5f0yollihcggzr6bghkwabkdz2y7g9)

`r emo::ji("book")` Readings:  minutes   

`r emo::ji("computer")` Activities: 45 minutes  
  
`r emo::ji("check")` Check-ins: 1

---

## Review: Statistical Distributions

`r emo::ji("play button")` [Required Video -- Review of Statistical Distributions](https://www.youtube.com/embed/KddbZr-ssZc)

---

## Simulating in R

`r emo::ji("play")` [Required Video -- Simulating Data in R](https://www.youtube.com/embed/LNg7kQbXvU0)

`r emo::ji("book")` [Required Reading -- _R Programming for Data Science_ : Simulation](https://bookdown.org/rdpeng/rprogdatascience/simulation.html)

---

`r emo::ji("check")` **Check-in: The `r`, `p`, `q`, and `d` functions**

Try to predict what the following outputs will be **WITHOUT** running the code
in R.  Drawing pictures of the relevant distributions may help.

(Yes, it is very easy to "cheat" on this question. But this is for your
practice, and I recommend you give it some thought.)

```{r, eval = FALSE}
## a
pnorm(-4, mean = 2, sd = 4)

## b
qnorm(.975, mean = 2, sd = 4)

## c
dnorm(1.5, mean = 2, sd = 4)

## d
rnorm(100, mean = 2, sd = 4)
```

---

## Setting a Random Number Seed

Functions like `rnorm()` rely on something called **pseudorandomness**.
Because computers can never be *truly* random, complicated processes are
implemented to make "random" number generation be so unpredictable as to behave
like true randomness.

This means that projects involving simulation are harder to make
**reproducible**. For example, here are two identical lines of code that give
different results!

```{r}
rnorm(1, mean = 0, sd = 1)
```


```{r}
rnorm(1, mean = 0, sd = 1)
```


Fortunately, pseudorandomness depends on a **seed**, which is an arbitrary
number where the randomizing process starts.  Normally, R will choose the seed
for you, from a pre-generated vector:

```{r}
head(.Random.seed)
```

However, you can also choose your own seed using the `set.seed()` function. This
guarantees your results will be consistent:

```{r}
set.seed(1234)
rnorm(1, mean = 0, sd = 1)
```


```{r}
set.seed(1234)
rnorm(1, mean = 0, sd = 1)
```

(Of course, it doesn't mean the results will be the same in every subsequent
run, unless you reset the seed in between each line of code!)

```{r}
set.seed(1234)
rnorm(1, mean = 0, sd = 1)

## Calling rnorm() again without a seed "resets" the seed! 
rnorm(1, mean = 0, sd = 1)
```

It is very important to always set a seed at the **beginning** of an R Markdown
document that contains any random steps, so that your knitted results are
consistent.

Note, though, that this only guarantees your knitted results will be the same
*if the code has not changed*.

Changing up any part of the code will re-randomize everything that comes after
it:

```{r}
set.seed(1234)
runif(1)
runif(1)
```

```{r}
set.seed(1234)
rnorm(1)
runif(1)
```


---


### Plotting Distributions

Here is the code that made one of the plots from the lecture video:

```{r}
my_samples <- data.frame(x = rchisq(1000, df = 5))

ggplot(my_samples, aes(x)) + 
  geom_histogram(bins = 40, aes(y = ..density..), fill = "grey", col = "white") + 
  stat_function(fun = ~dchisq(.x, df = 5), col = "cornflowerblue", lwd = 2) +
  theme_classic()
```

---

`r emo::ji("check")` **Check-in: Plotting Simulations**

Re-create this plot from the lecture slides:
(The two colors are "cornflowerblue" and "deeppink")

```{r, echo = FALSE}
my_samples <- data.frame(x = rnorm(1000, 
                                   mean = 10, 
                                   sd = 2))

ggplot(my_samples, aes(x)) + 
  geom_histogram(bins = 40, aes(y = ..density..), fill = "grey", col = "white") + 
  stat_function(fun = function(x) dnorm(x, mean = 10, sd = 2), col = "cornflowerblue", lwd = 2) +
  stat_function(fun = function(x) dnorm(x, mean = 10, sd = 2), col = "deeppink", lwd = 1) +
  theme_classic()
```

