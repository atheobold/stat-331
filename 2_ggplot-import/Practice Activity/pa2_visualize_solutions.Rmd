---
title: "PA 2: Using Data Visualization to Find the Group"
output:
  prettydoc::html_pretty:
    theme: tactile
    highlight: github
    css: styles.css
---

```{r, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(openintro)
library(forcats)
```

Today you will be creating and manipulating vectors, lists, and data frames to
uncover a top secret message.

Some advice:

* Work with those around you

* If you aren't sure how to make a specific plot or how to customize a plot, 
look over the *R for Data Science* textbook, all of the plots in this activity 
are included in the textbook. 

* Google is your friend! If you aren't sure how to accomplish a certain task, 
type what you are trying to accomplish into Google and see what other people are
saying. Generally, adding `ggplot` to the end of your search will help make your
search results more relevant! 

* Finally, don't forget to use your team members and course Discord as resources. 


# Part One

We will be exploring the `nycflights` data from the **openintro** package. 

1. Install and load the **openintro** package. 

```{r}
library(openintro)
```

2. Create a scatterplot of the relationship between the departure time 
(`dep_time`) and the month of the departure (`month`). 

```{r}
ggplot(data = nycflights) + 
  geom_point(mapping = aes(x = month, y = dep_delay)) 
```

**Checkpoint:** This plot should be unsatisfying! Think critically about a 
better way to visualize this relationship. 

*Hint:* Think about what type of variable `month` behaves like! 


# Part Two 

In order to create the plot we want, `month` needs to be a character
variable, not a numeric variable. Write the code to convert `month` into a 
character data type. 

```{r}
nycflights <- nycflights %>% 
  mutate(month = as.character(month))

```

1. Create a visualization of the relationship between the departure delay 
(`dep_delay`) and the month of the departure (`month`) that allows for you to 
see the **shape** of the distribution of the departure delays. 

```{r}
ggplot(data = nycflights) + 
  geom_boxplot(mapping = aes(y = dep_delay, x = month)) 

```

2. Add the origin of the flight (`origin`) to your visualization. 

```{r}
# Option 1 -- facets
ggplot(data = nycflights) + 
  geom_boxplot(mapping = aes(y = dep_delay, x = month)) +
  facet_wrap(~ origin)

# Option 2 -- color
ggplot(data = nycflights) + 
  geom_boxplot(mapping = aes(y = dep_delay, x = month, fill = origin)) 

```


# Part Three

Use your final plot to address the following questions:

1. During what month did the **second** longest delay occur at EWR?  

**Month = 6; June**

2. During what month did the **second** longest delay occur at JFK?

**Month = 6; June**

3. During what month did the **second** longest delay occur at LGA? 

**Month = 9 ; September**

