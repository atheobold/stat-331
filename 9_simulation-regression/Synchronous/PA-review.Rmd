---
title: "Linear Regression & Simulation"
date: "November 15, 2022"
author: "Stat 331"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "slide-style.css"]
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---


```{r, include = FALSE}
knitr::opts_chunk$set(fig.align = "center", 
                      echo = FALSE, 
                      message = FALSE, 
                      warning = FALSE, 
                      fig.width = 8, 
                      fig.height = 6)

options(htmltools.dir.version = FALSE)

library(openintro)
library(broom)
library(gridExtra)
library(kableExtra)
library(png)
library(xaringanthemer)
library(xaringan)
library(tidyverse)
library(flair)
library(moderndive)


style_duo_accent(
  primary_color      = "#0F4C81", # pantone classic blue
  secondary_color    = "#B6CADA", # pantone baby blue
  header_font_google = google_font("Raleway"),
  text_font_google   = google_font("Raleway", "300", "300i"),
  code_font_google   = google_font("Source Code Pro"),
  text_font_size     = "30px"
)
```

class: inverse

.larger[The next two weeks...]

--

.pull-left[
.bitlarger[**Regression & Simulation**]
]

--

.pull.right[

</br>
.bitlarger[**Predictive Modeling**]
]

---

.larger[Linear Regression]

$$
  response = intercept + slope \cdot explanatory + noise
$$
--

.pull-left[
```{r 2, echo = FALSE, fig.width = 5, fig.height = 4, fig.align = 'center'}
ggplot(data = bdims, aes(y = wgt, x = hgt)) + 
  geom_point() +
  scale_x_continuous("Explanatory Variable", labels = NULL) + 
  scale_y_continuous("Response Variable", labels = NULL)
```
]

.pull-right[

</br>
<center>
$\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 \cdot x$

$\epsilon_i \sim N(0, \sigma^2)$
]

---

.larger[Fitting a Linear Regression]

```{r, echo= TRUE}
lm(score ~ age, data = evals)
```

---

.larger[Using the `|>`]

```{r, echo = TRUE, eval = FALSE}
evals |>
  lm(score ~ age, data = .)
```

--

```
Error in is.data.frame(data): object '.' not found
```
--

</br>
</br>

<center>

.large[**What happened???**]

---

class: middle, inverse

.larger[Placeholder]

Piping is an infix operator (e.g., `2 + 2`) that pipes the LHS of the pipe into
the **first** argument of the function on RHS of the pipe

.pull-left[
```{r, echo = TRUE, eval = FALSE}
evals %>%
  lm(score ~ age, data = .)
```

With `%>%`, if the LHS **should not** be used in the **first** argument, a `.`
can be used to reference where the LHS should go.
]

.pull-right[
```{r, echo = TRUE, eval = FALSE}
evals |>
  lm(score ~ age, data = _)
```

`|>` **does not** have a placeholder. However, as of R 4.2, `|>` can use `_` as
a placeholder but only with **named** arguments.
]

[Interesting blog about differences by Isabella Vel√°squez](https://towardsdatascience.com/understanding-the-native-r-pipe-98dea6d8b61b)

---

.bitlarger[Accessing Residuals & Fitted Values]

```{r, echo = TRUE}
evals_lm <- evals |> 
  lm(score ~ age, data = _)
```

.column-left[
***Objects in `evals_lm`***

`$fitted.values`
`$residuals`
]

.column-center[
</br>

***Functions to extract elements from `evals_lm`***

- `resid()` 
- `fitted()`
]

.column-right[
</br>
</br>
</br>

***Function to make a tibble of elements from `evals_lm`***

`broom::augment()`
]

---

class: middle

.larger[An Example]

.pull-left[

```{r, echo = TRUE}
evals_lm$residuals |> 
  head(4)
```

```{r, echo = TRUE}
resid(evals_lm) |> 
  head(4)
```

]

.pull-right[
```{r, echo = TRUE}
broom::augment(evals_lm)
```

]

---

.larger[Plotting Residuals]

```{r, echo = TRUE, out.height = "40%", out.width = "40%"}
evals_lm |> 
  broom::augment() |> 
  ggplot(mapping = aes(y = .resid, x = .fitted)) +
  geom_point()
```


---

class: inverse

.huge-text[Simulating Data]

---

.larger[Functions in R]

- `r` stands for for **random sampling**: generate a random value from a 
specific distribution

--

- `p` for **probability** (CDF): i.e. compute the probability of observing a
value **less than** `x` (cumulative)

--

- `q` stands for **quantile**: given a probability `p`, compute the x-value
such that $P(X < x) = p$

--

- `d` stands for **density** (PDF): compute the height of distribution curve
(absolute)

---

.larger[Distributions in R]

- Uniform -- `unif`

- Normal -- `norm`

- t -- `t`

- Chi-Squared -- `chisq`

- Binomial -- `binom`
