---
title: "Midterm Instructions"
author: "Stat 331"
output: rmdformats::readthedown
---

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(kableExtra)
library(forcats)
library(ggtext)
```



## Introduction

### Policies

- You may use: any online resources, including anything posted on Canvas. 
  * Online resources used, outside of the _R for Data Science_ textbook, are 
  required to be properly cited. A citation can be a simple link to the webpage
  that was used as a resource. 
- You may **NOT** contact anyone, inside or outside this class, during the
  duration of the exam.  This includes email, chat/messenger services, and
  posting on online forums and message boards.
- You may **NOT** use exam materials from previous years.
- Violations of academic honesty include accessing and using any illegal
  materials, using external resources and neglecting to cite the sources, 
  giving or receiving help on this exam including looking at
  other student's exams, allowing other students to look at your own exam,
  and / or revealing any information about this exam or future exams to someone
  who has not yet taken it.
- Students who exhibit academic misconduct will be reported to the Office of
  Student Rights and Responsibilities; academic dishonesty may ultimately be
  punishable by earning an F in this course.
- You may **not** discuss the exam with any other students until after the
  exams have been returned to **all** students.
- If you witness others exhibiting academic misconduct, you have a duty to
  report them to your professor.

 
### Instructions

- Please note that you will need to use the data documentation in order to
  successfully complete this exam.
- The problems on this exam do not necessarily need to be completed
  sequentially, e.g., if you cannot accomplish problem 1, you may still be able
  to accomplish problem 2.
- Some parts to problems may need to be completed sequentially. If you cannot
  complete part (a), please write some skeleton code **and** your thought
  process for completing part (b).
- If you cannot accomplish a problem, please leave the code that you tried 
**and** write a description of your thinking and how you tried to accomplish the 
problem. These two components will allow for me to award you partial credit for
the problem. 
  * For example, tell me where you wanted to get and what you tried trying to 
  get there.
  * For the problem you cannot accomplish, please **leave your code there** and
  set your code chunk option to `error = TRUE`, to allow for the document to be
  knit even if there are errors. 
- All questions should be answered **using R code**.  Make sure your code
  prints out only the information that directly answers the question. 
  * **Penalties will be given if your `.html` file has extra output beyond that
  which answers the question.**
-  Submit both your `.Rmd` and `.html` files on Canvas by the end of the
  allotted time. 
- Only your knitted file will be graded, so make sure the knitted output
contains all your answers!
  
### The Dataset

Parts Two, Three, and Four of this exam pertain to the dataset `min_wage.csv`
posted in the Midterm Module on Canvas.

Documentation for this dataset can be found [here](https://github.com/Lislejoem/Minimum-Wage-by-State-1968-to-2017/tree/master).

*Note:* You can also find the code that the author used to clean the data. It
**is** permissible to look at this code, but **do not** copy-and-paste from that
source.

</br>

---

</br>

## Part One: General R Questions  [50 points]

**Fill out your answers in the Part One Quiz on Canvas.**

**It may be helpful to check your answers by producing code!**

</br>

__1. Suppose I create an object with the following:__

```{r}
a <- 10
```

__Which of the following is an accurate statement about `a`?__

*Check all that apply*

(a) `a` is an atomic vector.
(b) `a` is a numeric vector.
(c) `a` has the object class `integer`.
(d) `length(a)` is equal to `1`.
(e) `a + c(1,4,7)` will give an error.
(f) `as.character(a)` will return `"10"`

<!-- Correct: a, b, d, f -->

</br>

__2. Consider the following output:__

```{r, echo = FALSE}
mystery_object <- matrix(rnorm(12), nrow = 3, ncol = 4)
```

```{r}
str(mystery_object)
```

__What object structure is `mystery_object`?__

(a) A vector
(c) A matrix
(d) A data frame
(e) A list

</br>

__3. Suppose `student_names` is a **character vector** containing the names of 
students in a particular class.  For example, one entry of `student_names` might 
be `"Brad Pitt"`, and another might be `"Jeffrey Armstrong"`.  You may assume 
there are no middle names or two-word first or last names.__

__Which of the following will return the **_full names_** of students whose
*first name* starts with an A?__

*Check all that apply*

```{r, include = FALSE}
student_names <- c("Brad Pitt", 
                   "Jeffrey Armstrong", 
                   "Marilyn Foraker",
                   "Allison Theobold",
                   "Laura Smith", 
                   "Allen Klein")

```

(a) `str_extract(student_names, "^A")`
<!-- Only selects letter A -->
(b) `str_extract(student_names, "^A.*")`
<!-- Extracts first AND last name -->
(c) `str_extract(student_names, "^A[a-z]*")`
<!-- Extracts first name! -->
(d) `str_extract(student_names, "A[a-z]* ")`
<!-- Extracts first name! -->
(e) `str_subset(student_names, "^A")`
<!-- Extracts first AND last name.  -->
(f) `str_subset(student_names, "^A.*")`
<!-- Extracts first AND last name.  -->
(g) `str_subset(student_names, "^A[a-z]*")`
<!-- Extracts first AND last name.  -->
(h) `str_subset(student_names, "A[a-z]*")`
<!-- Extracts first AND last name plus other names.  -->

</br>

__4. Suppose you are interested in summarizing the demographics of students at 
Cal Poly. You have 20,000 survey responses for a variety of variables, including
gender, race, and ethnicity. For some groups, there aren't many responses. So,
you decide to lump together the smaller groups.__

__Which of the following will create an "other" group for levels of `race` that
appear fewer than 10% of the time?__

*Check all that apply* 

(a) `fct_lump(race)`
<!-- wrong -->
(b) `fct_lump_prop(race, prop = 0.1)`
<!-- correct -->
(c) `fct_lump_n(race, n = 3)`
<!-- wrong -->
(d) `fct_lump_lowfreq(race, other_level = "Other")`
<!-- wrong -->
(e) `fct_lump_min(race, min = 2000)`
<!-- correct -->

</br>

__5. Suppose, your resulting "lumped" demographic table looks like this:__ 

```{r, echo = FALSE}
data <- tibble(race = c(rep("African American", 171), 
                        rep("Hispanic/Latino", 3077), 
                        rep("Native American", 27),
                        rep("Non-Resident Alien", 475), 
                        rep("Unknown/Other", 548), 
                        rep("Asian American", 1965), 
                        rep("Multiracial", 1718), 
                        rep("White", 12019)
  )
)
               
data %>% 
  mutate(race = fct_lump_prop(race, 0.15)) %>% 
  count(race) %>% 
  kable() %>% 
  kable_styling()
```

__What are some issues with representing the data in this way?__

</br>

---

</br>

## Part Two: Short Answer [100 points]

**Please submit your .Rmd and .html for this section to Canvas**
*Please use the default R Markdown format for this section.*

For all questions, please show your work in code. It is expected that **all** of
the code for each question be visible in your knitted HTML file. 

```{r, include = FALSE}
min_wage <- read_csv(here::here("6_Midterm", "Minimum Wage Data.csv"))
```

__1. How many entries in this dataset had footnote `"(b)"`, where the laws 
applied only to women and minors?__

```{r, echo = FALSE, eval = FALSE}
min_wage %>% 
  mutate(b_foot = str_detect(`Footnote`, "(b)")) %>% 
  count(b_foot)

# 80 (b) Footnotes
```

</br>

__2. Which states / territories had the highest and lowest minimum wage in each
year?  (Use the `Effective.Minimum.Wage` dollar amount.)__

**Note:** You do not need to output *all* of the states. Rather, include your
code and a preview of what the results look like. 

```{r, eval = FALSE, echo = FALSE}
min_wage %>% 
  group_by(Year) %>% 
  slice_max(Effective.Minimum.Wage, n = 1) %>% 
  select(State, Effective.Minimum.Wage)

min_wage %>% 
  group_by(Year) %>% 
  slice_min(Effective.Minimum.Wage, n = 1) %>% 
  select(State, Effective.Minimum.Wage)
```

</br>

__3. Which states / territories had the largest change in minimum wage
(difference between high and low values) in each year? (Use the Department of 
Labor values.)__

```{r, echo = FALSE, eval = FALSE}
min_wage %>% 
  mutate(wage_diff = 
           Department.Of.Labor.Cleaned.High.Value - 
           Department.Of.Labor.Cleaned.Low.Value
         ) %>% 
  group_by(Year) %>% 
  slice_max(wage_diff, n = 1) %>% 
  select(State, wage_diff)
```

</br>

__4. Consider only Alabama, California, and Massachusetts. Make a plot comparing
their minimum wage in 2020 dollars (`Effective.Minimum.Wage.2020.Dollars`) over
time:__

```{r, echo = FALSE, eval = FALSE}
min_wage %>%
  filter(State %in% c("California", "Alabama", "Massachusetts")) %>%
  ggplot(aes(x = Year, 
             y = Effective.Minimum.Wage.2020.Dollars, 
             color = State)
         ) +
  geom_line() + 
  labs(x = "Year", 
       y = "Minimum Wage \n(Adjusted to 2020 Dollars)", 
       title = "Effective Minimum Wage for </br> <span style = 'color: pink;'>Alabama</span>, <span style = 'color: green;'>California</span>, and <span style = 'color: blue;'>Massachusetts</span>") + 
  theme(legend.position = "none") +
  theme(plot.title = element_markdown())
```

</br>

__5. Create a new data frame with the following properties:__

- Each row should represent a different year of observations.
- Each column should represent one state
- Values should be the highest minimum wage
(`Department.Of.Labor.Cleaned.High.Value`) in that state for that particular
year

```{r, echo = FALSE, eval = FALSE}
min_wage %>% 
  select(Year, State, Department.Of.Labor.Cleaned.High.Value) %>% 
  pivot_wider(names_from = State, 
              values_from = Department.Of.Labor.Cleaned.High.Value
  )
```

</br>

---

</br>

## Part Three:  Open-Ended Analysis [150 points]

**Please submit your .Rmd and .html for this section to Canvas**
*In this section, you __may__ use any formatting options you wish.*

### How does minimum wage differ by region?

Decide on your own regional grouping for the states.  For example, you might 
consider East vs. West, North vs. South, or something more nuanced.  You are welcome
to reference any internet source to determine your grouping.

Compare the minimum wage between regions to come up with an interesting insight. 
For example: Did some regions grow faster than others? Do some regions tend to
have a higher minimum wage than others?  etc.

Create a write-up of approximately one printed page (including all plots and
tables) that tells a clear story. Your write-up must include *at least* one plot
and *at least* one summary statistic.

</br>

---

</br>

## Part Four: Oral Exam [50 points]

Pick **one** aspect of your code from you analysis in Part Three that you are
proud of.  Describe what your code accomplishes! Be specific and talk through
each line, connecting each component together. 
